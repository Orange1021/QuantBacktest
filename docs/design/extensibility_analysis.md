# æ¡†æ¶å¯æ‰©å±•æ€§åˆ†ææŠ¥å‘Š

## ä¸€ã€å½“å‰æ¡†æ¶çš„å¯æ‰©å±•æ€§è¯„ä¼°

### 1.1 æ¶æ„è®¾è®¡è¯„ä¼°

å½“å‰æ¡†æ¶é‡‡ç”¨**åˆ†å±‚è§£è€¦**è®¾è®¡ï¼Œå…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§åŸºç¡€ã€‚

#### âœ… å¯å¤ç”¨çš„ç»„ä»¶ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   é€šç”¨å±‚ï¼ˆ100%å¯å¤ç”¨ï¼‰               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“ DataProviderï¼ˆæ•°æ®è·å–æ¥å£ï¼‰      â”‚
â”‚ âœ“ BarDataï¼ˆKçº¿æ•°æ®æ¨¡å‹ï¼‰            â”‚
â”‚ âœ“ PositionDataï¼ˆæŒä»“æ•°æ®æ¨¡å‹ï¼‰      â”‚
â”‚ âœ“ Signal/Orderï¼ˆä¿¡å·/è®¢å•æ¨¡å‹ï¼‰     â”‚
â”‚ âœ“ Loggerï¼ˆæ—¥å¿—ç®¡ç†ï¼‰                â”‚
â”‚ âœ“ ConfigManagerï¼ˆé…ç½®ç®¡ç†ï¼‰         â”‚
â”‚ âœ“ RiskManagerï¼ˆé£é™©ç®¡ç†ï¼‰           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¿™äº›ç»„ä»¶å®Œå…¨ç‹¬ç«‹äºç­–ç•¥é€»è¾‘ï¼Œå¯ä»¥ç›´æ¥å¤ç”¨ã€‚

#### âš ï¸ éƒ¨åˆ†å¯å¤ç”¨çš„ç»„ä»¶ï¼ˆéœ€è¦é…ç½®ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¯é€‰å±‚ï¼ˆ70%å¯å¤ç”¨ï¼‰                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â—‹ StockFilterï¼ˆè‚¡ç¥¨ç­›é€‰å™¨ï¼‰         â”‚
â”‚   - å¯é…ç½®ç­›é€‰æ¡ä»¶                  â”‚
â”‚   - å¯æ·»åŠ æ–°çš„ç­›é€‰è§„åˆ™              â”‚
â”‚                                     â”‚
â”‚ â—‹ PositionManagerï¼ˆä»“ä½ç®¡ç†å™¨ï¼‰     â”‚
â”‚   - å¯é…ç½®ä»“ä½ç®—æ³•                  â”‚
â”‚   - å¯æ”¯æŒä¸åŒåŠ ä»“æ–¹å¼              â”‚
â”‚                                     â”‚
â”‚ â—‹ ExecutionEngineï¼ˆæ‰§è¡Œå¼•æ“ï¼‰       â”‚
â”‚   - VectorBTå›æµ‹                    â”‚
â”‚   - vn.pyå®ç›˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### âŒ éœ€è¦æ›¿æ¢çš„ç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç­–ç•¥å±‚ï¼ˆéœ€è¦é‡æ–°å®ç°ï¼‰             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ— ContinuousDeclineStrategyï¼ˆä¸»ç­–ç•¥ï¼‰â”‚
â”‚ âœ— SignalGeneratorï¼ˆä¿¡å·ç”Ÿæˆå™¨ï¼‰     â”‚
â”‚ âœ— é€‰è‚¡é€»è¾‘                          â”‚
â”‚ âœ— å‡ºåœºé€»è¾‘                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 1.2 å¯æ‰©å±•æ€§è¯„åˆ†

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| **æ•°æ®å±‚**| 95% | å®Œå…¨å¯å¤ç”¨ï¼Œæ¥å£ç»Ÿä¸€ |
| **æ‰§è¡Œå±‚**| 90% | VectorBTå’Œvn.pyæ”¯æŒä»»ä½•ç­–ç•¥ |
| **é£æ§å±‚**| 85% | å¯é…ç½®ï¼Œéœ€æ ¹æ®ç­–ç•¥å¾®è°ƒ |
| **ç­–ç•¥å±‚**| 40% | éœ€è¦é‡æ–°å®ç°æ ¸å¿ƒé€»è¾‘ |
| **æ•´ä½“** | **75%** | **è‰¯å¥½ï¼Œæœ‰æ”¹è¿›ç©ºé—´** |

---

### 1.3 å½“å‰æ¶æ„çš„ä¸è¶³

#### é—®é¢˜1ï¼šç­–ç•¥æ¥å£ä¸å¤ŸæŠ½è±¡

**ç°çŠ¶**ï¼š
```python
class ContinuousDeclineStrategy:
    def __init__(self, stock_filter, position_manager, ...):
        self.stock_filter = stock_filter
        self.position_manager = position_manager
        # ...

    def on_bar(self, bar):
        # ç¡¬ç¼–ç çš„ç­–ç•¥é€»è¾‘
        self.scan_stocks()
        self.monitor_positions()
        # ...
```

**é—®é¢˜**ï¼š
- ç­–ç•¥é€»è¾‘åˆ†æ•£åœ¨å¤šä¸ªæ–¹æ³•ä¸­
- æ²¡æœ‰ç»Ÿä¸€çš„ç­–ç•¥ç”Ÿå‘½å‘¨æœŸç®¡ç†
- éš¾ä»¥å¿«é€Ÿæ›¿æ¢ç­–ç•¥

**å»ºè®®æ”¹è¿›**ï¼š
```python
class BaseStrategy(ABC):
    @abstractmethod
    def initialize(self):
        """ç­–ç•¥åˆå§‹åŒ–"""
        pass

    @abstractmethod
    def before_trading(self, date):
        """ç›˜å‰å¤„ç†"""
        pass

    @abstractmethod
    def on_bar(self, bar):
        """Kçº¿å¤„ç†"""
        pass

    @abstractmethod
    def after_trading(self, date):
        """ç›˜åå¤„ç†"""
        pass
```

#### é—®é¢˜2ï¼šç»„ä»¶é—´è€¦åˆåº¦è¿‡é«˜

**ç°çŠ¶**ï¼š
```python
# åœ¨run_backtest.pyä¸­
strategy = ContinuousDeclineStrategy(config)
backtester = VectorBTBacktester(strategy)
```

**é—®é¢˜**ï¼š
- ä¸»è„šæœ¬ç¡¬ç¼–ç äº†ç­–ç•¥ç±»å
- åˆ‡æ¢ç­–ç•¥éœ€è¦ä¿®æ”¹ä»£ç 

**å»ºè®®æ”¹è¿›**ï¼š
```python
# é€šè¿‡é…ç½®æŒ‡å®šç­–ç•¥
strategy_class = load_strategy_from_config(config)
strategy = strategy_class(config)
backtester = VectorBTBacktester(strategy)
```

#### é—®é¢˜3ï¼šç¼ºå°‘ç­–ç•¥é…ç½®æ¨¡æ¿

**ç°çŠ¶**ï¼š
- åªæœ‰ä¸€ä¸ªç­–ç•¥é…ç½®æ–‡ä»¶

**é—®é¢˜**ï¼š
- å¤šä¸ªç­–ç•¥éš¾ä»¥ç®¡ç†
- å‚æ•°å®¹æ˜“æ··æ·†

**å»ºè®®æ”¹è¿›**ï¼š
```
configs/
â”œâ”€â”€ strategy/
â”‚   â”œâ”€â”€ continuous_decline.yaml    # æŒç»­ä¸‹è·Œç­–ç•¥
â”‚   â”œâ”€â”€ ma_crossover.yaml          # å‡çº¿äº¤å‰ç­–ç•¥
â”‚   â”œâ”€â”€ momentum.yaml              # åŠ¨é‡ç­–ç•¥
â”‚   â””â”€â”€ grid_trading.yaml          # ç½‘æ ¼äº¤æ˜“
```

---

## äºŒã€ç†æƒ³çš„å¤šç­–ç•¥æ¶æ„

### 2.1 æ’ä»¶åŒ–ç­–ç•¥è®¾è®¡

```python
# strategy_registry.py
class StrategyRegistry:
    """ç­–ç•¥æ³¨å†Œè¡¨"""

    _strategies = {}

    @classmethod
    def register(cls, name: str):
        """æ³¨å†Œç­–ç•¥è£…é¥°å™¨"""
        def decorator(strategy_class):
            cls._strategies[name] = strategy_class
            return strategy_class
        return decorator

    @classmethod
    def get_strategy(cls, name: str) -> Type[BaseStrategy]:
        """æ ¹æ®åç§°è·å–ç­–ç•¥ç±»"""
        return cls._strategies.get(name)

    @classmethod
    def list_strategies(cls) -> List[str]:
        """åˆ—å‡ºæ‰€æœ‰å·²æ³¨å†Œç­–ç•¥"""
        return list(cls._strategies.keys())
```

**ä½¿ç”¨æ–¹å¼**ï¼š
```python
@StrategyRegistry.register("continuous_decline")
class ContinuousDeclineStrategy(BaseStrategy):
    pass

@StrategyRegistry.register("ma_crossover")
class MACrossoverStrategy(BaseStrategy):
    pass

@StrategyRegistry.register("momentum")
class MomentumStrategy(BaseStrategy):
    pass
```

### 2.2 é…ç½®é©±åŠ¨çš„ç­–ç•¥åŠ è½½

```yaml
# config.yaml
strategy:
  name: "continuous_decline"      # æŒ‡å®šç­–ç•¥åç§°
  params: {...}
```

```python
# ä¸»è„šæœ¬
strategy_name = config['strategy']['name']
StrategyClass = StrategyRegistry.get_strategy(strategy_name)
strategy = StrategyClass(config['strategy']['params'])
```

---

### 2.3 å¤šç­–ç•¥ç»„åˆ

```python
class PortfolioStrategy(BaseStrategy):
    """å¤šç­–ç•¥ç»„åˆ"""

    def __init__(self, strategies: List[BaseStrategy]):
        self.strategies = strategies

    def on_bar(self, bar):
        # æ¯ä¸ªç­–ç•¥ç‹¬ç«‹è¿è¡Œ
        for strategy in self.strategies:
            strategy.on_bar(bar)

        # æ±‡æ€»ä¿¡å·
        signals = []
        for strategy in self.strategies:
            signals.extend(strategy.get_signals())

        # é£é™©è°ƒæ•´
        self.risk_manager.adjust_signals(signals)

        # æ‰§è¡Œ
        self.executor.execute(signals)
```

---

## ä¸‰ã€å¦‚ä½•æ‰©å±•æ–°ç­–ç•¥

### 3.1 æ–¹æ³•ä¸€ï¼šå®Œå…¨æ›¿æ¢ï¼ˆå½“å‰å¯è¡Œï¼‰

**æ­¥éª¤**ï¼š

1. **åˆ›å»ºæ–°ç­–ç•¥æ–‡ä»¶**
```bash
cp src/strategy/continuous_decline.py \
   src/strategy/new_strategy.py
```

2. **ä¿®æ”¹ç­–ç•¥é€»è¾‘**
```python
class NewStrategy(BaseStrategy):
    def on_bar(self, bar):
        # ä½ çš„ç­–ç•¥é€»è¾‘
        pass
```

3. **ä¿®æ”¹è¿è¡Œè„šæœ¬**
```python
# åœ¨run_backtest.pyä¸­
# from src.strategy.continuous_decline import ContinuousDeclineStrategy
from src.strategy.new_strategy import NewStrategy

# strategy = ContinuousDeclineStrategy(config)
strategy = NewStrategy(config)
```

**ä¼˜ç‚¹**ï¼š
- ç®€å•ç›´æ¥
- å®Œå…¨æ§åˆ¶

**ç¼ºç‚¹**ï¼š
- éœ€è¦ä¿®æ”¹ä»£ç 
- éš¾ä»¥ç®¡ç†å¤šä¸ªç­–ç•¥
- ä¸åˆ©äºA/Bæµ‹è¯•

---

### 3.2 æ–¹æ³•äºŒï¼šç­–ç•¥å·¥å‚ï¼ˆæ¨èï¼‰

**æ­¥éª¤**ï¼š

1. **åˆ›å»ºç­–ç•¥åŸºç±»**
```python
# src/strategy/base_strategy.py
from abc import ABC, abstractmethod

class BaseStrategy(ABC):
    """ç­–ç•¥åŸºç±»ï¼Œæ‰€æœ‰ç­–ç•¥å¿…é¡»ç»§æ‰¿"""

    def __init__(self, params: dict):
        self.params = params
        self.name = params.get('name', 'Unnamed')

    @abstractmethod
    def initialize(self, context):
        """ç­–ç•¥åˆå§‹åŒ–"""
        pass

    @abstractmethod
    def before_trading(self, date, context):
        """ç›˜å‰å¤„ç†"""
        pass

    @abstractmethod
    def on_bar(self, bar, context):
        """Kçº¿å¤„ç†"""
        pass

    @abstractmethod
    def after_trading(self, date, context):
        """ç›˜åå¤„ç†"""
        pass
```

2. **åˆ›å»ºç­–ç•¥å·¥å‚**
```python
# src/strategy/factory.py
from src.strategy.continuous_decline import ContinuousDeclineStrategy
from src.strategy.ma_crossover import MACrossoverStrategy
from src.strategy.momentum import MomentumStrategy

class StrategyFactory:
    """ç­–ç•¥å·¥å‚ç±»"""

    _strategies = {
        'continuous_decline': ContinuousDeclineStrategy,
        'ma_crossover': MACrossoverStrategy,
        'momentum': MomentumStrategy,
    }

    @classmethod
    def create_strategy(cls, name: str, params: dict):
        """åˆ›å»ºç­–ç•¥å®ä¾‹"""
        if name not in cls._strategies:
            raise ValueError(f"æœªçŸ¥çš„ç­–ç•¥: {name}")
        return cls._strategies[name](params)

    @classmethod
    def register(cls, name: str, strategy_class):
        """æ³¨å†Œæ–°ç­–ç•¥"""
        cls._strategies[name] = strategy_class
```

3. **ä½¿ç”¨ç­–ç•¥å·¥å‚**
```python
# åœ¨run_backtest.pyä¸­
from src.strategy.factory import StrategyFactory

strategy_name = config['strategy']['name']
strategy = StrategyFactory.create_strategy(strategy_name, config)
```

**ä¼˜ç‚¹**ï¼š
- æ— éœ€ä¿®æ”¹ä¸»ä»£ç 
- æ˜“äºç®¡ç†å¤šä¸ªç­–ç•¥
- æ”¯æŒA/Bæµ‹è¯•
- é…ç½®é©±åŠ¨

**ç¼ºç‚¹**ï¼š
- éœ€è¦ç»´æŠ¤ç­–ç•¥æ³¨å†Œè¡¨
- éœ€è¦ç»Ÿä¸€æ¥å£è®¾è®¡

---

### 3.3 æ–¹æ³•ä¸‰ï¼šæ’ä»¶åŒ–æ¶æ„ï¼ˆé«˜çº§ï¼‰

**è®¾è®¡**ï¼š
```
strategies/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ continuous_decline/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ strategy.py          # ç­–ç•¥å®ç°
â”‚   â””â”€â”€ config.yaml          # é»˜è®¤å‚æ•°
â”œâ”€â”€ ma_crossover/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ strategy.py
â”‚   â””â”€â”€ config.yaml
â””â”€â”€ momentum/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ strategy.py
    â””â”€â”€ config.yaml
```

**è‡ªåŠ¨åŠ è½½**ï¼š
```python
def load_strategies():
    """è‡ªåŠ¨åŠ è½½æ‰€æœ‰ç­–ç•¥æ’ä»¶"""
    strategies = {}
    for path in Path('strategies').iterdir():
        if path.is_dir() and path.name != '__pyc__':
            config_file = path / 'config.yaml'
            if config_file.exists():
                config = load_yaml(config_file)
                strategies[config['name']] = config
    return strategies
```

---

## å››ã€å®æˆ˜ï¼šæ·»åŠ å‡çº¿äº¤å‰ç­–ç•¥

### 4.1 ç­–ç•¥éœ€æ±‚åˆ†æ

**ç­–ç•¥é€»è¾‘**ï¼š
```
1. é€‰è‚¡ï¼šå…¨å¸‚åœºè‚¡ç¥¨ï¼ˆå¯è¿‡æ»¤ï¼‰
2. å…¥åœºï¼šé‡‘å‰ï¼ˆçŸ­æœŸå‡çº¿ä¸Šç©¿é•¿æœŸå‡çº¿ï¼‰
3. å‡ºåœºï¼šæ­»å‰ï¼ˆçŸ­æœŸå‡çº¿ä¸‹ç©¿é•¿æœŸå‡çº¿ï¼‰
4. é£æ§ï¼šæ­¢æŸ10%
```

**éœ€è¦å¤ç”¨çš„ç»„ä»¶**ï¼š
- âœ… DataProviderï¼ˆæ•°æ®è·å–ï¼‰
- âœ… PositionManagerï¼ˆä»“ä½ç®¡ç†ï¼‰
- âœ… RiskManagerï¼ˆé£æ§ï¼‰
- âœ… ExecutionEngineï¼ˆæ‰§è¡Œï¼‰

**éœ€è¦é‡å†™çš„ç»„ä»¶**ï¼š
- âŒ StockFilterï¼ˆé€‰è‚¡å¯ä»¥å…±ç”¨ï¼‰
- âŒ SignalGeneratorï¼ˆä¿¡å·ç”Ÿæˆé€»è¾‘ä¸åŒï¼‰
- âŒ ä¸»ç­–ç•¥é€»è¾‘

### 4.2 å®ç°æ­¥éª¤

#### æ­¥éª¤1ï¼šåˆ›å»ºç­–ç•¥ç±»

```python
# src/strategy/ma_crossover.py
from typing import List
import pandas as pd

@StrategyRegistry.register("ma_crossover")
class MACrossoverStrategy(BaseStrategy):
    """å‡çº¿äº¤å‰ç­–ç•¥"""

    def __init__(self, params: dict):
        super().__init__(params)
        self.fast_window = params.get('fast_window', 20)
        self.slow_window = params.get('slow_window', 50)
        self.stop_loss = params.get('stop_loss', 0.10)

    def initialize(self, context):
        """åˆå§‹åŒ–"""
        self.data_provider = context['data_provider']
        self.position_manager = context['position_manager']

    def before_trading(self, date, context):
        """ç›˜å‰å¤„ç†"""
        pass

    def on_bar(self, bar, context):
        """Kçº¿å¤„ç†"""
        symbol = bar.symbol

        # è·å–å†å²æ•°æ®
        start = bar.datetime - pd.Timedelta(days=100)
        df = self.data_provider.get_daily_bars(symbol, start, bar.datetime)

        # è®¡ç®—å‡çº¿
        df['ma_fast'] = df['close'].rolling(self.fast_window).mean()
        df['ma_slow'] = df['close'].rolling(self.slow_window).mean()

        # åˆ¤æ–­é‡‘å‰æ­»å‰
        if len(df) < self.slow_window:
            return

        current = df.iloc[-1]
        prev = df.iloc[-2]

        pos = self.position_manager.get_position(symbol)

        # é‡‘å‰ä¸”ç©ºä»“ â†’ ä¹°å…¥
        if (prev['ma_fast'] <= prev['ma_slow'] and
            current['ma_fast'] > current['ma_slow'] and
            pos is None):
            self.position_manager.open_position(
                symbol,
                price=current['close'],
                percent=0.10  # 10%ä»“ä½
            )

        # æ­»å‰ä¸”æŒä»“ â†’ å–å‡º
        elif (prev['ma_fast'] >= prev['ma_slow'] and
              current['ma_fast'] < current['ma_slow'] and
              pos is not None):
            self.position_manager.close_position(symbol)

        # æ­¢æŸ
        elif pos is not None and pos.pnl_percent <= -self.stop_loss:
            self.position_manager.close_position(symbol)

    def after_trading(self, date, context):
        """ç›˜åå¤„ç†"""
        pass
```

#### æ­¥éª¤2ï¼šåˆ›å»ºé…ç½®æ–‡ä»¶

```yaml
# configs/strategy/ma_crossover.yaml
strategy:
  name: "ma_crossover"
  params:
    fast_window: 20          # å¿«çº¿ï¼š20æ—¥å‡çº¿
    slow_window: 50          # æ…¢çº¿ï¼š50æ—¥å‡çº¿
    stop_loss: 0.10          # æ­¢æŸ10%
    max_position: 0.30       # æœ€å¤§ä»“ä½30%
```

#### æ­¥éª¤3ï¼šä¿®æ”¹è¿è¡Œè„šæœ¬

```python
# scripts/run_backtest.py

# æ”¯æŒå‘½ä»¤è¡Œé€‰æ‹©ç­–ç•¥
parser.add_argument(
    '--strategy',
    type=str,
    default='continuous_decline',
    help='ç­–ç•¥åç§°ï¼ˆcontinuous_decline/ma_crossover/momentumï¼‰'
)

# åˆ›å»ºç­–ç•¥
strategy_name = args.strategy or config['strategy']['name']
strategy = StrategyFactory.create_strategy(strategy_name, config)
```

#### æ­¥éª¤4ï¼šè¿è¡Œæ–°ç­–ç•¥

```bash
# è¿è¡Œå‡çº¿äº¤å‰ç­–ç•¥
python scripts/run_backtest.py \
  --strategy ma_crossover \
  --symbols "000001.SZ,600000.SH" \
  --start 2020-01-01 \
  --end 2023-12-31
```

---

## äº”ã€å»ºè®®ï¼šæ¡†æ¶æ”¹è¿›æ–¹å‘

### 5.1 çŸ­æœŸæ”¹è¿›ï¼ˆ1-2å¤©å·¥ä½œé‡ï¼‰

1. âœ… **åˆ›å»ºç­–ç•¥åŸºç±»**
   - å®šä¹‰ç»Ÿä¸€çš„åˆå§‹åŒ–ã€ç›˜å‰ã€ç›˜ä¸­ã€ç›˜åæ¥å£

2. âœ… **åˆ›å»ºç­–ç•¥å·¥å‚**
   - é›†ä¸­ç®¡ç†ç­–ç•¥æ³¨å†Œ
   - æ”¯æŒé€šè¿‡é…ç½®åŠ è½½ç­–ç•¥

3. âœ… **æ‹†åˆ†è¿è¡Œè„šæœ¬**
   - å°†ç­–ç•¥åŠ è½½é€»è¾‘ç‹¬ç«‹å‡ºæ¥
   - æ”¯æŒå‘½ä»¤è¡Œå‚æ•°é€‰æ‹©ç­–ç•¥

### 5.2 ä¸­æœŸæ”¹è¿›ï¼ˆ1-2å‘¨å·¥ä½œé‡ï¼‰

1. ğŸ“Š **ç­–ç•¥é…ç½®ä¸­å¿ƒåŒ–**
   - æ¯ä¸ªç­–ç•¥æœ‰ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶
   - æ”¯æŒå‚æ•°ç»§æ‰¿å’Œè¦†ç›–

2. ğŸ”§ **ç»„ä»¶åŒ–SignalGenerator**
   - å°†å…¥åœºã€å‡ºåœºä¿¡å·ç”Ÿæˆæ‹†åˆ†æˆç‹¬ç«‹ç»„ä»¶
   - æ”¯æŒä¿¡å·ç»„åˆï¼ˆAND/ORé€»è¾‘ï¼‰

3. ğŸ“ˆ **ç»Ÿä¸€çš„ç»©æ•ˆåˆ†æ**
   - æ‰€æœ‰ç­–ç•¥è¾“å‡ºç›¸åŒæ ¼å¼çš„ç»©æ•ˆæŠ¥å‘Š
   - æ”¯æŒç­–ç•¥å¯¹æ¯”ï¼ˆA/Bæµ‹è¯•ï¼‰

### 5.3 é•¿æœŸæ”¹è¿›ï¼ˆ1ä¸ªæœˆ+å·¥ä½œé‡ï¼‰

1. ğŸ§© **ç­–ç•¥æ’ä»¶åŒ–**
   - æ”¯æŒåŠ¨æ€åŠ è½½ç­–ç•¥
   - ç­–ç•¥çƒ­æ›´æ–°ï¼ˆä¸é‡å¯ç¨‹åºï¼‰

2. ğŸ—ï¸ **ç­–ç•¥ç»„åˆæ¡†æ¶**
   - æ”¯æŒå¤šç­–ç•¥å¹¶è¡Œè¿è¡Œ
   - èµ„é‡‘åˆ†é…å’Œé£é™©ç®¡ç†
   - ç­–ç•¥æƒé‡ä¼˜åŒ–

3. ğŸ¤– **ç­–ç•¥ç®¡ç†åå°**
   - Webç•Œé¢ç®¡ç†ç­–ç•¥
   - å®æ—¶ç›‘æ§å’Œè°ƒä¼˜
   - ç­–ç•¥ç»©æ•ˆå¯è§†åŒ–

---

## å…­ã€ç»“è®º

### 6.1 å½“å‰æ¡†æ¶çŠ¶æ€

**æ‰©å±•æ€§ç­‰çº§**ï¼šB+ï¼ˆè‰¯å¥½ä½†éä¼˜ç§€ï¼‰

**ä¼˜åŠ¿**ï¼š
- æ¨¡å—åŒ–è®¾è®¡åˆç†
- æ•°æ®å±‚å’Œæ‰§è¡Œå±‚è§£è€¦è‰¯å¥½
- é…ç½®é©±åŠ¨ï¼Œçµæ´»åº¦é«˜
- VectorBTå’Œvn.pyåŸç”Ÿæ”¯æŒå¤šç­–ç•¥

**ä¸è¶³**ï¼š
- ç­–ç•¥å±‚æ¥å£ä¸å¤Ÿç»Ÿä¸€
- ç¼ºå°‘ç­–ç•¥å·¥å‚/æ³¨å†Œè¡¨
- ä¸»è„šæœ¬è€¦åˆè¾ƒé«˜

### 6.2 æ˜¯å¦å»ºè®®åŸºäºæ­¤æ¡†æ¶å¼€å‘æ–°ç­–ç•¥ï¼Ÿ

**ç­”æ¡ˆæ˜¯ï¼šâœ… å¼ºçƒˆæ¨è**

**ç†ç”±**ï¼š
1. æ•°æ®å±‚å’Œé£æ§å±‚å¯ä»¥ç›´æ¥å¤ç”¨
2. æ‰§è¡Œå±‚ï¼ˆå›æµ‹/å®ç›˜ï¼‰æ— éœ€ä¿®æ”¹
3. åªéœ€è¦é‡å†™ç­–ç•¥é€»è¾‘ï¼ˆå 30%å·¥ä½œé‡ï¼‰
4. æ”¹è¿›åçš„ä»£ç é‡æ§åˆ¶åœ¨200-300è¡Œ/ç­–ç•¥

**é¢„è®¡æ–°ç­–ç•¥å¼€å‘æ—¶é—´**ï¼š
- ç†Ÿæ‚‰æ¡†æ¶åï¼š**2-3å¤©**å®Œæˆä¸€ä¸ªç­–ç•¥
- åŒ…å«å›æµ‹è°ƒä¼˜ï¼š**1-2å‘¨**è¾¾åˆ°å¯ç”¨çŠ¶æ€

### 6.3 å»ºè®®çš„å¼€å‘æµç¨‹

```
1. é˜…è¯»è®¾è®¡æ–‡æ¡£ï¼ˆarchitecture.mdï¼‰
2. ç†è§£æŒç»­ä¸‹è·Œç­–ç•¥å®ç°ï¼ˆ1-2å°æ—¶ï¼‰
3. å¤åˆ¶å¹¶ä¿®æ”¹ç­–ç•¥æ–‡ä»¶ï¼ˆåŠå¤©ï¼‰
4. ç¼–å†™æ–°ç­–ç•¥é…ç½®æ–‡ä»¶ï¼ˆ1å°æ—¶ï¼‰
5. ä½¿ç”¨VectorBTå¿«é€ŸéªŒè¯ï¼ˆ1-2å¤©ï¼‰
6. å‚æ•°è°ƒä¼˜å’Œæµ‹è¯•ï¼ˆ1-2å¤©ï¼‰
```

---

## ä¸ƒã€ç¤ºä¾‹ï¼šå¿«é€Ÿæ·»åŠ æ–°ç­–ç•¥æ¨¡æ¿

å¦‚æœåªæƒ³å¿«é€Ÿæµ‹è¯•ä¸€ä¸ªç­–ç•¥æƒ³æ³•ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æœ€å°åŒ–æ¨¡æ¿ï¼š

```python
# src/strategy/quick_strategy.py
from src.strategy.base_strategy import BaseStrategy

class QuickStrategy(BaseStrategy):
    """å¿«é€Ÿç­–ç•¥æ¨¡æ¿ï¼ˆé€‚åˆéªŒè¯æƒ³æ³•ï¼‰"""

    def on_bar(self, bar, context):
        # è·å–å†å²æ•°æ®
        df = context['data_provider'].get_daily_bars(
            bar.symbol,
            bar.datetime - pd.Timedelta(days=30),
            bar.datetime
        )

        # ä½ çš„é€»è¾‘
        if len(df) < 2:
            return

        # ç®€å•ç¤ºä¾‹ï¼šä»Šå¤©æ¶¨äº†å°±ä¹°å…¥ï¼Œè·Œäº†å°±å–å‡º
        today_return = (df['close'].iloc[-1] / df['close'].iloc[-2]) - 1

        if today_return > 0.02:  # æ¶¨2%ä»¥ä¸Šä¹°å…¥
            context['position_manager'].open_position(bar.symbol, bar.close, 0.10)

        elif today_return < -0.02:  # è·Œ2%ä»¥ä¸Šå–å‡º
            context['position_manager'].close_position(bar.symbol)

        # ç­–ç•¥å®Œæˆï¼åªéœ€è¦10è¡Œä»£ç 
```

**è¿è¡Œ**ï¼š
```bash
python scripts/run_backtest.py --strategy quick_strategy
```

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0
**æœ€åæ›´æ–°**ï¼š2025-01-18
**è¯„ä¼°ç»“æœ**ï¼šå½“å‰æ¡†æ¶å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§ï¼Œé€šè¿‡å°‘é‡æ”¹è¿›å¯ä»¥æ”¯æŒå¤šç­–ç•¥å¹¶è¡Œå¼€å‘å’Œè¿è¡Œ
