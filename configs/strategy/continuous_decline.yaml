# 持续下跌策略配置文件
# Continuous Decline Strategy Configuration

strategy:
  name: "ContinuousDeclineStrategy"
  description: "持续下跌抄底策略 - 筛选连续下跌股票并分层加仓"
  author: "Your Name"

  # 选股参数
  filter_params:
    # 筛选器类型（stock_filter/wencai_filter）
    filter_type: "wencai_filter"        # 使用问财筛选器（推荐，更智能）

    # 传统筛选器参数（filter_type=stock_filter时使用）
    decline_days_threshold: 7          # 连续下跌天数阈值（修改为7天）
    market_cap_threshold: 1000000000   # 最小市值（10亿，单位：元）
    stock_universe: "A_SHARE"          # 股票池：A股
    exclude_st:
      enabled: true                    # 是否排除ST股
      enabled: true                    # 是否排除退市整理期股票
    exclude_suspend: true              # 是否排除停牌股票

    # 问财筛选器参数（filter_type=wencai_filter时使用）
    # ⚠️ 注意：问财Cookie会过期（通常30天），需要定期从浏览器重新获取
    # 获取方法：登录https://www.iwencai.com，使用浏览器开发者工具复制Cookie
    wencai_params:
      cookie: "Ths_iwencai_Xuangu_mt4zcu73qjh83vi4y5pr2nybkxnoenud; ta_random_userid=wx7wznncgr; cid=baf1622e8eea6272fc9d2ce794097ea61746875841; u_ukey=A10702B8689642C6BE607730E11E6E4A; u_uver=1.0.0; u_dpass=vGdGzLxENUG6ZwHZ8OGxTLDmIKF5Rmb8llOwW2ykQE%2BOjjddJ4Q3jJx2t9d7r%2FnWHi80LrSsTFH9a%2B6rtRvqGg%3D%3D; u_did=3C009AF7CFB64A2EB8000AEAFC84637E; u_ttype=WEB; ttype=WEB; user=MDpteF9qOWIxb3JjZjQ6Ok5vbmU6NTAwOjc0MzYyNjc0MDo3LDExMTExMTExMTExLDQwOzQ0LDExLDQwOzYsMSw0MDs1LDEsNDA7MSwxMDEsNDA7MiwxLDQwOzMsMSw0MDs1LDEsNDA7OCwwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMSw0MDsxMDIsMSw0MDoxNjo6OjczMzYyNjc0MDoxNzYzNDU2NjQ5Ojo6MTcyNzQxMzM4MDo2MDQ4MDA6MDoxNGIzMGE3OWJlZTVjNTFhNTY3MTdmYzJkODI2NDZlNWI6ZGVmYXVsdF81OjA%3D; userid=733626740; u_name=mx_j9b1orcf4; escapename=mx_j9b1orcf4; ticket=196b8d3516872396b9d61a7861207165; user_status=0; utk=e46397c25629b3cfcd6e1bfa34125d4a; sess_tk=eyJ0eXAiOiJKV1QiLCJhbGciOiJFUzI1NiIsImtpZCI6InNlc3NfdGtfMSIsImJ0eSI6InNlc3NfdGsifQ.eyJqdGkiOiI1YjZlNjQ4MjJkZmMxNzY3YTU1MTVjZWU5YmE3MzA0YjEiLCJpYXQiOjE3NjM0NTY2NDksImV4cCI6MTc2NDA2MTQ0OSwic3ViIjoiNzMzNjI2NzQwIiwiaXNzIjoidXBhc3MuaXdlbmNhaS5jb20iLCJhdWQiOiIyMDIwMTExODUyODg5MDcyIiwiYWN0Ijoib2ZjIiwiY3VocyI6ImY0MDc5ZjJmNWU4MWZiNTgxYzdkM2YwNmRmZDgxOGQ0NjAwMTZiZDUwOWNkYjUzZmM2NmYxNTcyNzMyYWU5NDIifQ.UkFAerw8xEr2LfqqGeam3Rb4rLLihUcex-GXwoGFbbiyZsv3LnPn7j7ZzdQJn8aUERlDZLuCOowpGnxZoFUhbw; cuc=80pgkax6oqk0; THSSESSID=167576bfd4ec1b26c44679b2a4; v=A5ZHNl7v431o69fZCVulVBKh50edN9a7LHUO_QDsgu8V_zj5aMcqgfwLXsXT"
      fallback_on_error: true          # 失败时回退到stock_filter
      market_cap_threshold: 1000000000  # 最小市值（10亿，单位：元），可选

  # 入场参数
  entry_params:
    decline_percent_per_layer: 0.01    # 每层下跌百分比（1%）
    position_percent_per_layer: 0.10   # 每层加仓百分比（10%，基于总资金）
    max_layers: 8                      # 最大加仓层数（8次补仓，共80%）
    initial_position_size: 0.20        # 首次建仓仓位（20%）

  # 出场参数
  exit_params:
    exit_on_first_decline: true        # 上涨后首次下跌即清仓
    use_trailing_stop: false           # 是否使用跟踪止损
    trailing_stop_percent: 0.05        # 跟踪止损百分比（5%）

  # 风险控制
  risk_params:
    single_position_limit: 0.30        # 单票最大仓位30%
    total_position_limit: 0.80         # 总仓位最大80%
    stop_loss_percent: 0.15            # 止损线15%
    daily_loss_limit: 0.05             # 单日最大亏损5%
    max_holding_days: 60               # 最大持仓天数（防止套牢）

  # 资金参数
  capital_params:
    initial_capital: 1000000           # 初始资金100万
    commission_rate: 0.0003            # 佣金费率（万分之三）
    stamp_duty: 0.0005                 # 印花税（万分之五，仅卖出时收取）
    transfer_fee: 0.00001              # 过户费（十万分之一，仅沪市股票收取）
    slippage: 0.001                    # 滑点（0.1%）
    min_commission: 5                  # 最低佣金（元）

# 数据配置
data:
  provider: "tushare"                  # 数据提供商（tushare/akshare/local）
  tushare_token: "your_token_here"     # Tushare token（如使用）
  local_data_dir: "data/raw"           # 本地数据目录（如使用）
  adjust_type: "qfq"                   # 复权类型（qfq: 前复权，hfq: 后复权）
  price_field: "close"                 # 使用收盘价作为决策依据

# 回测配置
backtest:
  start_date: "2024-08-01"            # 回测开始日期
  end_date: "2024-11-01"              # 回测结束日期
  symbols:                            # 回测标的
    type: "A_SHARE"                   # 类型：A_SHARE（全市场）/LIST（指定列表）/INDEX（指数成分股）
    list: []                          # 如type=LIST，填写具体的股票代码列表
    index_code: "000001.SH"           # 如type=INDEX，填写指数代码
  benchmark: "000001.SH"              # 业绩基准（上证指数）
  output_dir: "data/backtest_results"  # 回测结果输出目录
  save_trades: true                   # 是否保存交易记录
  save_positions: true                # 是否保存持仓记录

# 实盘配置（vn.py）
live:
  gateway: "ctp"                       # 交易网关（ctp/xtp/futu）
  account_file: "configs/live/account.yaml"  # 账户配置文件
  symbols:                            # 交易标的
    - "600000.SH"
    - "000001.SZ"
  trading_hours:                      # 交易时间（A股）
    pre_open: "09:15"
    open: "09:30"
    noon_start: "11:30"
    noon_end: "13:00"
    close: "15:00"
  log_level: "INFO"                   # 日志级别
  max_workers: 8                      # 最大工作线程数（用于扫描股票）

# 日志配置
logging:
  level: "INFO"                        # 日志级别（DEBUG/INFO/WARNING/ERROR）
  file: "logs/strategy.log"           # 日志文件路径
  max_bytes: 10485760                 # 单个日志文件最大大小（10MB）
  backup_count: 10                    # 备份文件数量
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"  # 日志格式
